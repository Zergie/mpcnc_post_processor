[gcode_macro PROBE_TOOL]
description: Probes tool and sets tool offset
variable_offset: 2.036
gcode:
  SAVE_GCODE_STATE
  G91

  M118 Probe Touchplate (fast)
  PROBE PROBE_SPEED=15 SAMPLES=1

  M118 Probe Touchplate
  G0 Z5 F5000
  PROBE PROBE_SPEED=5 SAMPLES=1

  SET_KINEMATIC_POSITION Z=2

  G0 Z5 F5000
  RESTORE_GCODE_STATE

[gcode_macro SAVE_Z_RESULT]
description: Helper for PROBE_TOOL
variable_value: 0
gcode:
    {% set value = printer.probe.last_z_result %}
    MESSAGE MSG="z_result set to {value}"
